<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Env√≠o Directo - Google Apps Script</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            white-space: pre-wrap;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Env√≠o Directo - Google Apps Script</h1>
        <p>Esta p√°gina env√≠a datos directamente al Google Apps Script para probar la funcionalidad.</p>
        
        <div class="radio-group">
            <label>
                <input type="radio" name="tipoMatricula" value="regular" checked>
                Regular CTP 2026
            </label>
            <label>
                <input type="radio" name="tipoMatricula" value="planNacional">
                Plan Nacional 2026
            </label>
        </div>
        
        <div class="form-group">
            <label for="cedulaEstudiante">C√©dula del Estudiante:</label>
            <input type="text" id="cedulaEstudiante" value="999999999" placeholder="Ingrese la c√©dula">
        </div>
        
        <div class="form-group">
            <label for="primerApellido">Primer Apellido:</label>
            <input type="text" id="primerApellido" value="TEST" placeholder="Primer apellido">
        </div>
        
        <div class="form-group">
            <label for="segundoApellido">Segundo Apellido:</label>
            <input type="text" id="segundoApellido" value="APELLIDO" placeholder="Segundo apellido">
        </div>
        
        <div class="form-group">
            <label for="nombreEstudiante">Nombre:</label>
            <input type="text" id="nombreEstudiante" value="ESTUDIANTE" placeholder="Nombre del estudiante">
        </div>
        
        <div class="form-group">
            <label for="fechaNacimiento">Fecha de Nacimiento:</label>
            <input type="date" id="fechaNacimiento" value="2008-01-01">
        </div>
        
        <div class="form-group">
            <label for="nacionalidad">Nacionalidad:</label>
            <input type="text" id="nacionalidad" value="Costarricense" placeholder="Nacionalidad">
        </div>
        
        <div class="form-group">
            <label for="repitente">Repitente:</label>
            <select id="repitente">
                <option value="No">No</option>
                <option value="S√≠">S√≠</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="adecuacion">Adecuaci√≥n:</label>
            <select id="adecuacion">
                <option value="No">No</option>
                <option value="S√≠">S√≠</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="especialidad">Especialidad:</label>
            <input type="text" id="especialidad" value="CONTABILIDAD" placeholder="Especialidad">
        </div>
        
        <div class="form-group">
            <label for="nivel">Nivel:</label>
            <select id="nivel">
                <option value="D√©cimo">D√©cimo</option>
                <option value="Und√©cimo">Und√©cimo</option>
                <option value="Duod√©cimo">Duod√©cimo</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="seccion">Secci√≥n:</label>
            <input type="text" id="seccion" value="A" placeholder="Secci√≥n">
        </div>
        
        <div class="form-group">
            <label for="telefonoEstudiante">Tel√©fono del Estudiante:</label>
            <input type="text" id="telefonoEstudiante" value="8888-8888" placeholder="Tel√©fono">
        </div>
        
        <div class="form-group">
            <label for="nombreMadre">Nombre de la Madre:</label>
            <input type="text" id="nombreMadre" value="MAR√çA MADRE" placeholder="Nombre de la madre">
        </div>
        
        <div class="form-group">
            <label for="cedulaMadre">C√©dula de la Madre:</label>
            <input type="text" id="cedulaMadre" value="111111111" placeholder="C√©dula de la madre">
        </div>
        
        <div class="form-group">
            <label for="telefonoMadre">Tel√©fono de la Madre:</label>
            <input type="text" id="telefonoMadre" value="7777-7777" placeholder="Tel√©fono de la madre">
        </div>
        
        <div class="form-group">
            <label for="parentescoMadre">Parentesco de la Madre:</label>
            <input type="text" id="parentescoMadre" value="Madre" placeholder="Parentesco">
        </div>
        
        <div class="form-group">
            <label for="viveConEstudianteMadre">¬øVive con el estudiante? (Madre):</label>
            <select id="viveConEstudianteMadre">
                <option value="S√≠">S√≠</option>
                <option value="No">No</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="direccionMadre">Direcci√≥n de la Madre:</label>
            <input type="text" id="direccionMadre" value="San Jos√©, Costa Rica" placeholder="Direcci√≥n">
        </div>
        
        <div class="form-group">
            <label for="nombrePadre">Nombre del Padre:</label>
            <input type="text" id="nombrePadre" value="JUAN PADRE" placeholder="Nombre del padre">
        </div>
        
        <div class="form-group">
            <label for="cedulaPadre">C√©dula del Padre:</label>
            <input type="text" id="cedulaPadre" value="222222222" placeholder="C√©dula del padre">
        </div>
        
        <div class="form-group">
            <label for="telefonoPadre">Tel√©fono del Padre:</label>
            <input type="text" id="telefonoPadre" value="6666-6666" placeholder="Tel√©fono del padre">
        </div>
        
        <div class="form-group">
            <label for="parentescoPadre">Parentesco del Padre:</label>
            <input type="text" id="parentescoPadre" value="Padre" placeholder="Parentesco">
        </div>
        
        <div class="form-group">
            <label for="direccionPadre">Direcci√≥n del Padre:</label>
            <input type="text" id="direccionPadre" value="San Jos√©, Costa Rica" placeholder="Direcci√≥n">
        </div>
        
        <div class="form-group">
            <label for="rutaTransporte">Ruta de Transporte:</label>
            <input type="text" id="rutaTransporte" value="Ruta 1" placeholder="Ruta de transporte">
        </div>
        
        <div class="form-group">
            <label for="enfermedad">¬øTiene enfermedad?:</label>
            <select id="enfermedad">
                <option value="No">No</option>
                <option value="S√≠">S√≠</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="detalleEnfermedad">Detalle de Enfermedad:</label>
            <input type="text" id="detalleEnfermedad" value="" placeholder="Detalle de enfermedad">
        </div>
        
        <div class="form-group">
            <label for="firmaEncargada">Firma de la Encargada:</label>
            <input type="text" id="firmaEncargada" value="MAR√çA MADRE" placeholder="Firma">
        </div>
        
        <div class="form-group">
            <label for="firmaEncargado">Firma del Encargado:</label>
            <input type="text" id="firmaEncargado" value="JUAN PADRE" placeholder="Firma">
        </div>
        
        <div class="form-group">
            <label for="fecha">Fecha:</label>
            <input type="date" id="fecha" value="2026-01-15">
        </div>
        
        <div class="form-group">
            <label for="observaciones">Observaciones:</label>
            <input type="text" id="observaciones" value="Prueba de env√≠o directo" placeholder="Observaciones">
        </div>
        
        <button class="btn" onclick="enviarPrueba()">üöÄ Enviar Prueba al Google Apps Script</button>
        
        <div id="resultado" class="result" style="display: none;"></div>
    </div>

    <script>
        // URL del Google Apps Script
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyFmC36fkkraO5amUr9rScr8rWiMUDK7ksqXK8FSCc0ci03NKw9Awo47lCy3tbJ3795Hw/exec';
        
        async function enviarPrueba() {
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.style.display = 'block';
            resultadoDiv.className = 'result info';
            resultadoDiv.textContent = 'üì§ Enviando datos de prueba...';
            
            try {
                // Obtener tipo de matr√≠cula seleccionado
                const tipoMatricula = document.querySelector('input[name="tipoMatricula"]:checked').value;
                console.log('üîç Tipo de matr√≠cula seleccionado:', tipoMatricula);
                
                // Recolectar datos del formulario
                const formData = recolectarDatosPrueba();
                formData.tipoMatricula = tipoMatricula;
                formData.hojaDestino = tipoMatricula === 'regular' ? 'REGULAR CTP 2026' : 'PLAN NACIONAL 2026';
                
                console.log('üìä Datos a enviar:', formData);
                console.log('üéØ Hoja destino:', formData.hojaDestino);
                
                // Crear URLSearchParams
                const urlParams = new URLSearchParams();
                Object.keys(formData).forEach(key => {
                    const valor = formData[key] !== null && formData[key] !== undefined ? formData[key] : '';
                    urlParams.append(key, valor);
                });
                
                console.log('üìã Par√°metros URL:', urlParams.toString());
                
                // Enviar datos
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: urlParams.toString()
                });
                
                console.log('‚úÖ Respuesta del servidor:', response);
                
                // Con no-cors, asumimos √©xito
                resultadoDiv.className = 'result success';
                resultadoDiv.textContent = `‚úÖ Datos enviados exitosamente a la hoja: ${formData.hojaDestino}\n\nüìä Total de campos enviados: ${Object.keys(formData).length}\nüîç Tipo de matr√≠cula: ${tipoMatricula}\nüéØ Hoja destino: ${formData.hojaDestino}\n\nüìã Campos enviados:\n${Object.keys(formData).join('\n')}`;
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultadoDiv.className = 'result error';
                resultadoDiv.textContent = `‚ùå Error al enviar: ${error.message}`;
            }
        }
        
        function recolectarDatosPrueba() {
            return {
                numeroIdentificacion: document.getElementById('cedulaEstudiante').value,
                tipoIdentificacion: 'C√âDULA',
                primerApellido: document.getElementById('primerApellido').value,
                segundoApellido: document.getElementById('segundoApellido').value,
                nombre: document.getElementById('nombreEstudiante').value,
                fechaNacimiento: document.getElementById('fechaNacimiento').value,
                edad: '',
                identidadGenero: '',
                nacionalidad: document.getElementById('nacionalidad').value,
                repitente: document.getElementById('repitente').value,
                refugiado: '',
                discapacidad: document.getElementById('adecuacion').value,
                especialidad: document.getElementById('especialidad').value,
                nivel: document.getElementById('nivel').value,
                seccion: document.getElementById('seccion').value,
                titulo: '',
                celularEstudiante: document.getElementById('telefonoEstudiante').value,
                encargada: document.getElementById('nombreMadre').value,
                cedula: document.getElementById('cedulaMadre').value,
                celular: document.getElementById('telefonoMadre').value,
                parentesco: document.getElementById('parentescoMadre').value,
                viveConEstudiante: document.getElementById('viveConEstudianteMadre').value,
                direccionExacta: document.getElementById('direccionMadre').value,
                encargado: document.getElementById('nombrePadre').value,
                cedula2: document.getElementById('cedulaPadre').value,
                celular2: document.getElementById('telefonoPadre').value,
                parentezco2: document.getElementById('parentescoPadre').value,
                otroCel: '',
                direccion2: document.getElementById('direccionPadre').value,
                movimiento: 'NUEVA MATR√çCULA 2026',
                columna1: '',
                columna2: '',
                columna3: '',
                columna4: '',
                rutaTransporte: document.getElementById('rutaTransporte').value,
                enfermedad: document.getElementById('enfermedad').value,
                detalleEnfermedad: document.getElementById('detalleEnfermedad').value,
                firmaEncargada: document.getElementById('firmaEncargada').value,
                firmaEncargado: document.getElementById('firmaEncargado').value,
                fecha: document.getElementById('fecha').value,
                observaciones: document.getElementById('observaciones').value,
                timestamp: new Date().toISOString()
            };
        }
    </script>
</body>
</html>
