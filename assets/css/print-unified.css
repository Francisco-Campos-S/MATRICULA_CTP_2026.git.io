/* Estilos de impresión unificados */
@media print {
    /* Configuración de página */
    @page {
        size: A4 portrait;
        margin: 0.6cm;
        marks: none;
    }

    /* Estilos generales */
    html, body {
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        font-family: Arial, sans-serif !important;
        font-size: 10pt !important;
        line-height: 1.1 !important;
        color: black !important;
    }
    
    /* Escalado global */
    body {
        transform: scale(0.92);
        transform-origin: top center;
    }
    
    /* Ocultar elementos no necesarios */
    header, .consulta-section, .form-actions, button, .btn,
    .mensaje-consulta, footer, .print-info, .app-footer,
    .print-section-title, #loadingSpinner, #successMessage {
        display: none !important;
    }
    
    /* Estructura del formulario */
    .container, .matricula-form {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: visible !important;
        height: auto !important;
        display: block !important;
        background: white !important;
        border: none !important;
        box-shadow: none !important;
    }
    
    /* Título de la boleta - eliminado */
    .matricula-form::before {
        content: none !important;
    }
    
    /* Estilos para el encabezado de impresión */
    .print-header {
        display: none;
    }

    @media print {
        .print-header {
            display: block !important;
            margin-bottom: 20px !important;
            text-align: center !important;
        }

        .main-title {
            font-size: 18pt !important;
            font-weight: bold !important;
            margin: 15px 0 !important;
            text-align: center !important;
            font-family: Arial, sans-serif !important;
        }

        /* Ocultar la información duplicada */
        .tipo-matricula-section,
        .nivel-especialidad-section,
        [data-tipo-matricula],
        [data-nivel],
        [data-especialidad],
        [data-seccion],
        [data-ruta],
        .print-info-general,
        .print-info-box,
        .print-info-row {
            display: none !important;
        }

        /* Ocultar solo el primer encabezado redundante */
        .form-section:first-of-type .section-header {
            display: none !important;
        }
        
        /* Forzar solo blanco y negro en impresión */
        * {
            background: white !important;
            background-color: white !important;
            color: black !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        /* Mostrar encabezados de sección en impresión sin emoticonos y sin colores */
        .section-header {
            display: block !important;
            background: white !important;
            background-color: white !important;
            color: black !important;
            padding: 3px 5px !important;
            margin: 0 0 5px 0 !important;
            border: 2px solid black !important;
            page-break-after: avoid !important;
        }
        
        .section-header h2 {
            background: white !important;
            background-color: white !important;
            color: black !important;
            margin: 0 !important;
            padding: 2px !important;
            font-size: 11pt !important;
            text-align: center !important;
            font-weight: bold !important;
            font-family: Arial, sans-serif !important;
        }

        /* Asegurar que todos los encabezados sean visibles */
        .form-section .section-header {
            display: block !important;
            visibility: visible !important;
        }

        /* Reemplazar contenido de encabezados sin emoticonos */
        .form-section:nth-of-type(2) .section-header h2 {
            font-size: 0 !important;
        }
        .form-section:nth-of-type(2) .section-header h2::after {
            content: "DATOS DEL ESTUDIANTE" !important;
            font-size: 11pt !important;
        }

        /* Encabezado de madre/encargada */
        .form-section:nth-of-type(3) .section-header h2 {
            font-size: 0 !important;
        }
        .form-section:nth-of-type(3) .section-header h2::after {
            content: "DATOS DE LA MADRE O ENCARGADA" !important;
            font-size: 11pt !important;
        }

        /* Encabezado de padre/encargado */
        .form-section:nth-of-type(4) .section-header h2 {
            font-size: 0 !important;
        }
        .form-section:nth-of-type(4) .section-header h2::after {
            content: "DATOS DEL PADRE O ENCARGADO" !important;
            font-size: 11pt !important;
        }

        /* Encabezado de declaración y firmas */
        .form-section:nth-of-type(5) .section-header h2 {
            font-size: 0 !important;
        }
        .form-section:nth-of-type(5) .section-header h2::after {
            content: "DECLARACIÓN Y FIRMAS" !important;
            font-size: 11pt !important;
        }

        /* Ocultar elementos duplicados */
        .form-section .print-info-general,
        .form-section .print-info-box,
        .section-header,
        .print-section-title {
            display: none !important;
        }
    }

    @media print {
        .consulta-section,
        .tipo-matricula-options,
        .nivel-especialidad-fields {
            display: none !important;
        }

        .print-info-general {
            page-break-inside: avoid !important;
        }
    }
    
    /* Secciones del formulario */
    .form-section {
        display: block !important;
        margin-bottom: 8px !important;
        border: 1px solid #000 !important;
        page-break-inside: avoid !important;
        width: 100% !important;
        clear: both !important;
    }
    
    /* Encabezados de sección - solo blanco y negro */
    .section-header {
        background: white !important;
        background-color: white !important;
        color: black !important;
        padding: 3px 5px !important;
        margin: 0 0 5px 0 !important;
        border: 2px solid black !important;
        page-break-after: avoid !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
    
    .section-header h2 {
        background: white !important;
        background-color: white !important;
        color: black !important;
        margin: 0 !important;
        padding: 2px !important;
        font-size: 11pt !important;
        text-align: center !important;
        font-weight: bold !important;
        font-family: Arial, sans-serif !important;
    }
    
    /* Filas y columnas */
    .form-row {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 2px !important;
        padding: 3px !important;
        page-break-inside: avoid !important;
        margin: 0 !important;
    }
    
    .form-row.five-columns .form-column { width: 19% !important; flex: 1 1 19% !important; }
    .form-row.four-columns .form-column { width: 24% !important; flex: 1 1 24% !important; }
    .form-row.three-columns .form-column { width: 32% !important; flex: 1 1 32% !important; }
    .form-row.two-columns .form-column { width: 49% !important; flex: 1 1 49% !important; }
    
    /* Columnas */
    .form-column {
        padding: 3px !important;
        margin: 0 !important;
    }
    
    /* Grupos de formulario */
    .form-group {
        margin-bottom: 4px !important;
        page-break-inside: avoid !important;
    }
    
    /* Etiquetas */
    .form-group label {
        display: block !important;
        font-weight: bold !important;
        font-size: 9pt !important;
        margin-bottom: 1px !important;
    }
    
    /* Campos de entrada */
    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100% !important;
        border: 1px solid #000 !important;
        padding: 1px !important;
        font-size: 10pt !important;
        height: auto !important;
        min-height: 0 !important;
        background: white !important;
        color: black !important;
    }
    
    /* Textareas */
    textarea {
        height: 20px !important;
        max-height: 20px !important;
        overflow: hidden !important;
    }
    
    /* Declaración */
    .declaration {
        padding: 3px !important;
        text-align: center !important;
        margin: 5px 0 !important;
        border-top: 1px solid #000 !important;
    }
    
    .declaration p {
        font-weight: bold !important;
        margin: 0 !important;
        font-size: 10pt !important;
    }
    
    /* Observaciones y fecha */
    .observaciones-fecha-container {
        display: flex !important;
        gap: 10px !important;
        margin-top: 15px !important;
        margin-bottom: 10px !important;
        padding: 5px !important;
        page-break-inside: avoid !important;
    }
    
    .observaciones-grupo {
        flex: 2 !important;
    }
    
    .observaciones-grupo label {
        font-weight: bold !important;
        font-size: 10pt !important;
        margin-bottom: 5px !important;
        display: block !important;
    }
    
    .observaciones-grupo textarea {
        width: 100% !important;
        min-height: 30px !important;
        border: 1px solid black !important;
        padding: 3px !important;
        font-size: 9pt !important;
    }
    
    .fecha-grupo {
        flex: 1 !important;
        text-align: center !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
    }
    
    .fecha-grupo label {
        font-weight: bold !important;
        font-size: 10pt !important;
        margin-bottom: 5px !important;
    }
    
    .fecha-grupo input {
        border: 1px solid black !important;
        padding: 3px !important;
        font-size: 9pt !important;
        text-align: center !important;
    }

    /* Ocultar elementos duplicados */
    .print-observaciones-fecha,
    .print-observaciones-container,
    .print-observaciones-grupo,
    .print-observaciones-label,
    .print-observaciones-linea,
    .print-fecha-grupo,
    .print-fecha-label,
    .print-fecha-valor {
        display: none !important;
    }
    
    /* ELEMENTOS DE FIRMA */
    .print-firmas {
        display: block !important;
        visibility: visible !important;
        margin-top: 5px !important;
    }
    
    .firma-container {
        display: flex !important;
        justify-content: space-between !important;
        width: 100% !important;
    }
    
    .firma-lado-izquierdo,
    .firma-lado-derecho {
        width: 48% !important;
    }
    
    .firma-linea {
        margin-bottom: 10px !important;
    }
    
    .firma-label {
        font-size: 8pt !important;
        font-weight: bold !important;
    }
    
    .firma-linea-blanca {
        border-bottom: 1px solid black !important;
        height: 1px !important;
        width: 100% !important;
        margin-top: 15px !important;
    }
    
    /* Footer permanente */
    .footer-permanent {
        display: block !important;
        visibility: visible !important;
        border-top: 1px solid #000 !important;
        margin-top: 5px !important;
        padding-top: 3px !important;
        text-align: center !important;
        page-break-inside: avoid !important;
    }
    
    .footer-permanent p {
        font-size: 7pt !important;
        margin: 1px 0 !important;
        line-height: 1.1 !important;
    }
}

/* Estilos específicos para Firefox */
@-moz-document url-prefix() {
    @media print {
        body {
            transform: scale(0.88);
            transform-origin: top center;
        }
        
        .form-group label {
            font-size: 8.5pt !important;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            font-size: 9pt !important;
        }
    }
}